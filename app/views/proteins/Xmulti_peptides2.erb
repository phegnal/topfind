<body bgcolor="Azure"></body>


<table border="1" >
	
	<!-- HEADER -->
	<thead>
		<tr>
			<th>Accession</th>		
			<th>Input Sequence</th>
			<th>Recommended Protein Name</th>
			<th>Other Names and IDs</th>
			<%if @spec%>
			<th>Species</th>
			<%end%>


			<%if @chromosome%>
			<th>Chromosome<br>Band</th>
			<%end%>

			<th>P<sub>10</sub> to P<sub>10</sub>'</th>
			<th>P<sub>1</sub>â€² Position</th> <!-- TODO change for C-termini! -->

			<%if @evidence%>
			<th>UniProt annotated start</th>
			<th>Isoform Start</th>
			<th>Alternative Spliced Start</th>
			<th>Cleaving Proteases</th>	
			<th>Other terminus evidences</th>
			<th>Alternative Translation Initiation Start</th>
			<%end%>

			<%if @proteaseWeb%>
			<th>Protease Web Connections</th>
			<%end%>

			<%if @domain%>
			<th>N-terminal Features <br>(Start to P<sub>1</sub>)</th> <!-- TODO change for C-termini! -->
			<th>Features At Position (P<sub>1</sub>')</th> <!-- TODO change for C-termini! -->
			<th>C-terminal Features <br>(P<sub>2</sub>' to End)</th> <!-- TODO change for C-termini! -->
			<th>Signalpeptide lost</th>
			<th>Propeptide lost</th>
			<th>Shed</th>
			<%end%>
		</tr>
	</thead>

	<!-- BODY -->
	<tbody>
		<% @mainarray.each_index do |i|%>
		<tr>	
			<% q = @mainarray.fetch(i)%>
			<td><a href="http://clipserve.clip.ubc.ca/topfind/proteins/<%= q[:acc]%>"><%= q[:acc]%></a></td>
			<td><%= q[:full_pep]%></td>
			<td>
				<%= q[:short_names]%>
			</td>
			<td>
				<% q[:all_names].each do |s|%>
				<%= s.name%><bsr>
				<%end%>
			</td>

			<%if @spec%>
			<td><%= q[:species]%></td>
			<%end%>

			<%if @chromosome%>
			<td>
				<% q[:chr].each do |a|%>
				<%= a %>
				<%end%>
			</td>
			<%end%>
		<td><%= q[:upstream]%> &#8595 <%= q[:pep]%></td>
		<td><%= q[:location].succ%></td>
		
		<%if @evidence%>
		<td><%= q[:uniprot].length > 0 ? "X" : " " %></td>
		<td><%= q[:isoforms].length > 0 ? "X" : " " %></td>
		<td><%= q[:ensembl].length > 0 ? "X" : " " %></td>		
		<td><% q[:proteases].collect{|p| p.shortname}.each do |s|%>
				<%= s %><br>	
				<%end%>				
		</td>
		<td><%= q[:otherEvidences].collect{|e| e.methodology}.join("<br>") %></td>
		<td><%= q[:tisdb].length > 0 ? "X" : " " %></td>
		<%end%>

		<%if @proteaseWeb%>
		<td><font size='2'><span class="nowrap"><%= @pw_paths[q[:acc] + "_"+ q[:location].to_s].collect{|path| 
			path.collect{|node|
				@pw_gnames[node[:id]].to_s
					}.join(" &#8594 ")		
				}.join(";<br>  ") %></span></font>
			</td>
			<%end%> <!-- end of protease web -->

			<%if @domain%>
			<td>
				<!--domains before  -->
				<%q[:domains_before].collect{|d| "#{d.name} (#{d.description})"}.uniq.each do |r|%>
				<%= r %><br>
				<%end%>
			</td>
			<td>
				<!--domains at  -->
				<%q[:domains_at].collect{|d| "#{d.name} (#{d.description})"}.uniq.each do |r|%>
				<%= r %><br>
				<%end%>
			</td>
			<td>
				<!--domains after  -->
				<%q[:domains_after].collect{|d| "#{d.name} (#{d.description})"}.uniq.each do |r|%>
				<%= r %><br>
				<%end%>
			</td>
			<td>
				<% if !q[:SignalLost].nil? & q[:SignalLost] then %> X <% end %>
			</td>
			<td>
				<% if !q[:ProPeptideLost].nil? & q[:ProPeptideLost] then %> X <% end %>
			</td>
			<td>
				<% if !q[:shed].nil? & q[:shed] then %> X <% end %>
			</td>
			<%end%> <!-- end of domains -->
		</tr>
		<% end %> <!-- end of loop over all proteins-->
	</tbody>
</table>
